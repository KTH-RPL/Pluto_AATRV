<launch>
    <!-- ================================================================== -->
    <!-- Helper & Pose Nodes (unchanged) -->
    <!-- ================================================================== -->
    <node name="corrected_robot_pose_publisher" pkg="detector" type="pose_corrector.py" output="screen"/>

    <!-- ================================================================== -->
    <!-- Obstacle Detector Node with Profiler -->
    <!-- ================================================================== -->
    <!-- The launch-prefix executes cProfile on the node.
         The profile data will be saved to 'detector.prof' inside your 'detector' package directory. -->
    <node name="detector" pkg="detector" type="detector.py" output="screen"
          launch-prefix="/home/sankeerth/pluto/bin/python3 -m cProfile -o $(find detector)/detector.prof">
        
        <!-- ... (parameters are unchanged) ... -->
        <param name="depth_topic"           value="/rsD455_node0/depth/image_rect_raw"/>
        <param name="obstacle_topic"        value="/detected_obstacles1"/>
        <param name="output_frame_id"       value="base_footprint"/>
        <param name="safety_buffer"         value="0.1"/>
        <param name="depth_scale_factor"    value="1000.0"/>
        <param name="~target_hz"            value="2.0"/>
        <rosparam param="uv_detector">
            row_downsample: 4
            col_scale: 0.5
            min_dist: 0.1
            max_dist: 8.0
            threshold_point: 3
            threshold_line: 2
            min_length_line: 6
        </rosparam>
        <rosparam param="depth_intrinsics">[392.1868, 393.0597, 323.7744, 236.8676]</rosparam>
        <rosparam param="body_to_camera_depth">[
            -0.002257, -0.000971,  0.999996,  0.068483,
             0.999962,  0.008356,  0.002265, -0.054542,
            -0.008358,  0.999964,  0.000952,  0.094245,
             0.0,       0.0,       0.0,       1.0
        ]</rosparam>
    </node>

    <!-- ================================================================== -->
    <!-- Costmap Generator Node with Profiler -->
    <!-- ================================================================== -->
    <!-- We also profile the costmap node.
         The profile data will be saved to 'costmap.prof' inside your 'detector' package directory. -->
    <node pkg="detector" type="costmap.py" name="global_costmap_generator" output="screen"
          launch-prefix="/usr/bin/python3 -m cProfile -o $(find detector)/costmap.prof">

        <!-- ... (parameters are unchanged) ... -->
        <param name="obstacle_topic" value="/detected_obstacles1" />
        <param name="costmap_topic" value="/global_costmap" />
        <param name="robot_pose_topic" value="/robot_pose" />
        <param name="global_frame" value="odom" />
        <param name="map_size" value="20.0" />
        <param name="resolution" value="0.1" />
        <param name="inflation_radius" value="0.5" />
        <param name="gradient_end_radius" value="1" />
        <param name="max_cost" value="100" />
        <param name="memory_duration" value="5.0" />
    </node>

    <!-- ================================================================== -->
    <!-- RViz Visualization (unchanged) -->
    <!-- ================================================================== -->
    <node name="rviz_detector" pkg="rviz" type="rviz" args="-d $(find detector)/src/rviz.rviz" required="true"/>
    
</launch>